<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <link
      rel="shortcut icon"
      href="../assets/icon/favicon2.ico"
      type="image/x-icon"
    />
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Beatles - Comunity</title>

    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="home.css" />
    <link rel="stylesheet" href="./src/style.css"></link>
    <script src="../js/funcoes.js"></script>
    <script src="./src/script.js" defer></script>

    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />

    <!-- scripts do Chart.js - 2022-1 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!--FONT AWESOME-->
    <script
      src="https://kit.fontawesome.com/9f7414eb10.js"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <div class="janela">
      <div class="header-left">
        <img src="../assets/logo.png" alt="logo" />

        <div class="hello">
          <h3>
            Olá, <span id="b_usuario">usuário</span>. <br />
            Divirta-se!
          </h3>
        </div>

        <div class="card-persona">
          <h3>Atual Persona: <span id="b_fkIntegrante">...</span></h3>
          <div id="kpi_integrante"></div>
        </div>



        <div class="btn-nav">
          <a href="./home.html"><h3>Home</h3></a>
        </div>

        <div class="btn-nav">
          <a href="./dashboard.html"><h3>Gráficos</h3></a>
        </div>

        <div class="btn-nav-white">
          <a href="./mural.html">
            <h3>Mural de Avisos</h3>
          </a>
        </div>

        



        <div class="btn-logout" onclick="limparSessao()">
          <h3>Sair</h3>
        </div>
      </div>

      <div class="main">
        <div class="content">
          <div class="container-teste">
            <h3>
              Abaixo, faça o nosso teste de personalidade, e descubra qual
              integrante dos beatles você seria!
            </h3>
          </div>

          <div class="input-box" id="btnQuiz">
            <button onclick="iniciarQuiz()" class="submit" type="submit">
              Fazer o teste
            </button>
          </div>


          <div class="container-slider" id="containerSlider" style="display: none">
            

            <!-- QUIZ -->
            <div class="container-slider" id="box-quiz">
              <!-- botão de passar para trás -->
              <button id="prev-button">
                <img src="../assets/arrow.png" alt="prev-button" />
              </button>
        
              <!-- slider QUIZ -->
              <div class="container-quiz">
                <!-- primeira pergunta -->
                <div class="slider on">
                  <h1>Informe o mês que você nasceu</h1>
                  <br/>
                  <div>
                    <input type="radio" id="jan-mar" name="mes" value="George" />
                    <label for="jan-mar">Janeiro - Março</label>
                  </div>
        
                  <div>
                    <input type="radio" id="abr-jun" name="mes" value="Paul" />
                    <label for="abr-jun">Abril - Junho</label>
                  </div>
        
                  <div>
                    <input type="radio" id="jul-set" name="mes" value="Ringo" />
                    <label for="jul-set">Julho - Setembro</label>
                  </div>
        
                  <div>
                    <input type="radio" id="out-dez" name="mes" value="John" />
                    <label for="out-dez">Outubro - Dezembro</label>
                  </div>
                </div>
        
                <!-- segunda pergunta -->
                <div class="slider">
                  <h1>Quem você seria em uma banda?</h1>
                  <br />
                  <div>
                    <input type="radio" id="vocalista" name="banda" value="John" />
                    <label for="vocalista">Vocalista</label>
                  </div>
        
                  <div>
                    <input type="radio" id="baixista" name="banda" value="Paul" />
                    <label for="baixista">Baixista</label>
                  </div>
        
                  <div>
                    <input type="radio" id="guitarrista" name="banda" value="George" />
                    <label for="guitarrista">Guitarrista</label>
                  </div>
        
                  <div>
                    <input type="radio" id="baterista" name="banda" value="Ringo" />
                    <label for="baterista">Baterista</label>
                  </div>
                </div>
        
                <!-- terceira pergunta -->
                <div class="slider">
                  <h1>Você em seu grupo é?</h1>
                  <br />
                  <div>
                    <input type="radio" id="quieto" name="grupo" value="George" />
                    <label for="quieto">Quieto</label>
                  </div>
        
                  <div>
                    <input type="radio" id="brincalhão" name="grupo" value="Ringo" />
                    <label for="brincalhão">Brincalhão</label>
                  </div>
        
                  <div>
                    <input type="radio" id="social" name="grupo" value="Paul" />
                    <label for="social">Social</label>
                  </div>
        
                  <div>
                    <input type="radio" id="lider" name="grupo" value="John" />
                    <label for="lider">Líder</label>
                  </div>
                </div>
        
                <!-- quarta pergunta -->
                <div class="slider">
                  <h1>Qual opção representa seus valores?</h1>
                  <br />
                  <div>
                    <input type="radio" id="amor" name="valores" value="Paul" />
                    <label for="amor">Amor</label>
                  </div>
        
                  <div>
                    <input type="radio" id="independencia" name="valores" value="George"/>
                    <label for="independencia">Independência</label>
                  </div>
        
                  <div>
                    <input type="radio" id="bondade" name="valores" value="John" />
                    <label for="bondade">Bondade</label>
                  </div>
        
                  <div>
                    <input type="radio" id="coragem" name="valores" value="Ringo" />
                    <label for="coragem">Coragem</label>
                  </div>
                </div>
        
                <!-- quinta pergunta -->
                <div class="slider">
                  <h1>Qual opção representa sua personalidade?</h1>
                  <br />
                  <div>
                    <input type="radio" id="calmo" name="personalidade" value="George"/>
                    <label for="calmo">Calmo</label>
                  </div>
        
                  <div>
                    <input type="radio" id="alegre" name="personalidade" value="Ringo"/>
                    <label for="alegre">Alegre</label>
                  </div>
        
                  <div>
                    <input type="radio" id="sociavel" name="personalidade" value="Paul"/>
                    <label for="sociavel">Sociável</label>
                  </div>
        
                  <div>
                    <input type="radio" id="inteligente" name="personalidade" value="John"/>
                    <label for="inteligente">Inteligente</label>
                  </div>
                </div>
        
                <!-- sexta pergunta -->
                <div class="slider">
                  <h1>Você se considera uma pessoa...</h1>
                  <br />
                  <div>
                    <input type="radio" id="extrovertida" name="pessoa" value="John" />
                    <label for="extrovertida">Extrovertida</label>
                  </div>
        
                  <div>
                    <input
                      type="radio" id="introvertida" name="pessoa" value="George"/>
                    <label for="introvertida">Introvertida</label>
                  </div>
        
                  <div>
                    <input type="radio" id="ambivertida" name="pessoa" value="Paul" />
                    <label for="ambivertida">Ambivertida</label>
                  </div>
        
                  <div>
                    <input type="radio" id="nan" name="pessoa" value="Ringo" />
                    <label for="nan">Não Sei</label>
                  </div>
                </div>
        
                <div class="slider">
                  <div class="input-box">
                  <button class="submit" onclick="verificar()">Verificar integrante</button>
                  </div>
                </div>
              </div>

              <button id="next-button">
                <img src="../assets/arrow.png" alt="next-button" />
              </button>
            </div>
          </div>

          <!-- resultado formulario -->
          <div id="resultado" style="display: none">
              <img id="resultado_img" src="" alt="resultado-img" />

              <div class="resultado_texto">
                <h2 id="resultado_nome"></h2>
                <p id="resultado_descricao"></p>
              </div>
            </div>

            <div class="album">
              <div>
                <h2>Vote dentre os álbuns abaixo o de sua preferência:</h2>
              </div>

              <div class="container-opcoes">
                <div class="album-voto">
                  <img id="album1" src="../assets/album-abbey.png" alt="resultado-img" />
                  <button class="btn-voto">Abbey Road</button>
                </div>
  
                <div class="album-voto">
                  <img id="album2" src="../assets/album-beatles.png" alt="resultado-img"/>
                  <button class="btn-voto">The Beatles</button>
                </div>
  
                <div class="album-voto">
                  <img id="album3" src="../assets/album-help.png" alt="resultado-img" />
                  <button class="btn-voto">Help!</button>
                </div>
                
              </div>
            
            </div>

          </div>
      </div>

    </div>
  </body>
</html>



<script>

    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    b_fkIntegrante.innerHTML = sessionStorage.PERSONA_USUARIO;
    
    
    function iniciarQuiz() {
      containerSlider.style.display = "flex";
      
      if(containerSlider.style.display === "flex") {
        btnQuiz.style.display = "none";
      }
  }
  
  var nomeIntegrante = sessionStorage.PERSONA_USUARIO;
  b_fkIntegrante.innerHTML = nomeIntegrante;

  if(nomeIntegrante == "John"){
    kpi_integrante.innerHTML = `<img src="../assets/persona-john.png" alt="" />`;
  } else if(nomeIntegrante == "Paul"){
    kpi_integrante.innerHTML = `<img src="../assets/persona-paul.png" alt="" />`;
  } else if(nomeIntegrante == "George"){
    kpi_integrante.innerHTML = `<img src="../assets/persona-george.png" alt="" />`;
  } else if(nomeIntegrante == "Ringo"){
    kpi_integrante.innerHTML = `<img src="../assets/persona-ringo.png" alt="" />`;
  }
  
  var integrantes = [];
  
  function verificar() {


    
    var mes = document.querySelector('input[name="mes"]:checked').value;
    var banda = document.querySelector('input[name="banda"]:checked').value;
    var personalidade = document.querySelector('input[name="personalidade"]:checked').value;
    var valores = document.querySelector('input[name="valores"]:checked').value;
    var grupo = document.querySelector('input[name="grupo"]:checked').value;
    var pessoa = document.querySelector('input[name="pessoa"]:checked').value;

    integrantes.push(mes, banda, personalidade, valores, grupo, pessoa);

    var idUsuario = sessionStorage.ID_USUARIO;
    
    
    
    // verificar qual nome mais aparece no array
    var countJohn = 0;
    var countGeorge = 0;
    var countPaul = 0;
    var countRingo = 0;

    for (var i = 0; i < integrantes.length; i++) {
      if (integrantes[i] == "John") {
        countJohn++;
      } else if (integrantes[i] == "George") {
        countGeorge++;
      } else if (integrantes[i] == "Paul") {
        countPaul++;
      } else if (integrantes[i] == "Ringo") {
        countRingo++;
      }
    }

    var integrante = 0;

    if (countJohn > countGeorge && countJohn > countPaul && countJohn > countRingo) {
      resultado.style.display = "flex";
      resultado_img.src = "../assets/persona-john.png";
      resultado_nome.innerHTML = "John Lennon";
     
      integrante = 1;
      resultado_descricao.innerHTML = "Assim como John, você é uma pessoa com uma personalidade extremamente forte e que sempre fala o que pensa sem se importar com o que os outros irão pensar a seu respeito.";    
    } 
    else if (countGeorge > countJohn && countGeorge > countPaul && countGeorge > countRingo) {
      resultado.style.display = "flex";
      resultado_img.src = "../assets/persona-george.png";
      resultado_nome.innerHTML = "Você é George Harrison";
     
      integrante = 4;
      resultado_descricao.innerHTML = "Assim como George, você é uma pessoa introspectiva, que não gosta de chamar atenção e que está sempre muito focada em todos seus objetivos.";
    } 
    else if (countPaul > countJohn && countPaul > countGeorge && countPaul > countRingo) {
      resultado.style.display = "flex";
      resultado_img.src = "../assets/persona-paul.png";
      resultado_nome.innerHTML = "Você é Paul McCartney";
     
      integrante = 2;
      resultado_descricao.innerHTML = "Assim como Paul, você é uma pessoa que tem um ótimo coração, sentimental e que sempre aplica suas emoções em qualquer coisa que faz.";
    } 
    else if (countRingo > countJohn && countRingo > countGeorge && countRingo > countPaul) {
      resultado.style.display = "flex";
      resultado_img.src = "../assets/persona-ringo.png";
      resultado_nome.innerHTML = "Você é Ringo Starr";
     
      integrante = 3;
      resultado_descricao.innerHTML = "Assim como Ringo, você é uma pessoa que é muito protetora com aqueles que ama e que sempre esta esbanjando seu ótimo humor em qualquer lugar que esteja.";
    } 


    fetch("/usuarios/alterar", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          idServer: idUsuario,
          fkIntegrante: integrante
          
        }),
      })
        .then(function (resposta) {
          console.log("resposta: ", resposta);
  
          if (resposta.ok) {
            // redireciona para a tela de login
            console.log("deu certo a alteração");
            sessionStorage.PERSONA_USUARIO = 
              integrante == 1 ? "John" : 
              integrante == 2 ? "Paul" : 
              integrante == 3 ? "Ringo" :
              integrante == 4 ? "George" : "..."
          } else {
            throw "Houve um erro ao tentar realizar o cadastro!";
          }
        })
        .catch(function (resposta) {
          console.log(`#ERRO: ${resposta}`);
        });

  }
</script>